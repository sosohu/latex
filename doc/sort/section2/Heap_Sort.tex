    
\begin{lstlisting}
void adjust_heap(int A[], int n, int root){
	while(1){
		int left = root*2 + 1 > n - 1? INT_MIN : A[root*2 + 1];
		int right = root*2 + 2 > n - 1? INT_MIN : A[root*2 + 2];
		if(A[root] < max(left, right)){
			if(left < right){
				swap(A[root], A[root*2+2]);
				root = root*2 + 2;
			}else{
				swap(A[root], A[root*2+1]);
				root = root*2 + 1;
			}
		}else
			break;
	}
}

//build max heap
void make_heap(int A[], int n){
	for(int i = n/2 - 1; i >= 0; i--){
		adjust_heap(A, n, i);
	}
}

void pop_heap(int A[], int n){
	if( n <= 1)	return;
	swap(A[0], A[n-1]);
	adjust_heap(A, n-1, 0);
}

void heap_sort(int A[], int n){
	make_heap(A, n);
	for(int i = n; i > 0; i--)
		pop_heap(A, i);
}
\end{lstlisting}
